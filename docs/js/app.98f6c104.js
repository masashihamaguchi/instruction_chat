(function(e){function t(t){for(var i,r,o=t[0],a=t[1],u=t[2],f=0,p=[];f<o.length;f++)r=o[f],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&p.push(s[r][0]),s[r]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i]);d&&d(t);while(p.length)p.shift()();return c.push.apply(c,u||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],i=!0,o=1;o<n.length;o++){var a=n[o];0!==s[a]&&(i=!1)}i&&(c.splice(t--,1),e=r(r.s=n[0]))}return e}var i={},s={app:0},c=[];function r(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],a=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var d=a;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},3890:function(e,t,n){"use strict";n("71f2")},"3cef":function(e,t,n){"use strict";n("d5b7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("7a23"),s=(n("b64b"),function(e){return Object(i["m"])("data-v-729dff48"),e=e(),Object(i["l"])(),e}),c={key:0,class:"login"},r=s((function(){return Object(i["g"])("h1",null,"Instruction Chat",-1)}));function o(e,t,n,s,o,a){var u=Object(i["o"])("Chat");return 0===Object.keys(o.user).length?(Object(i["k"])(),Object(i["f"])("div",c,[r,Object(i["g"])("button",{onClick:t[0]||(t[0]=function(){return a.login&&a.login.apply(a,arguments)})},"ログイン")])):(Object(i["k"])(),Object(i["d"])(u,{key:1,user:o.user},null,8,["user"]))}var a=n("1da1"),u=(n("96cf"),function(e){return Object(i["m"])("data-v-b54d8f92"),e=e(),Object(i["l"])(),e}),d={class:"wrapper"},f=u((function(){return Object(i["g"])("header",{class:"header"},[Object(i["g"])("h1",null,"Instruction Chat")],-1)})),p={class:"message"},l={class:"message__container",ref:"container"},b={class:"form"},m={class:"form__container"};function h(e,t,n,s,c,r){var o=Object(i["o"])("Message");return Object(i["k"])(),Object(i["f"])("div",d,[f,Object(i["g"])("div",p,[Object(i["g"])("div",l,[Object(i["h"])(i["b"],{name:"message",tag:"div"},{default:Object(i["s"])((function(){return[(Object(i["k"])(!0),Object(i["f"])(i["a"],null,Object(i["n"])(c.messages,(function(e){return Object(i["k"])(),Object(i["d"])(o,{class:"message__component",key:e.id,content:e.content,icon:e.icon,timestamp:e.timestamp,displayName:e.displayname,isMine:e.isMine,onDeleteMessage:function(t){return r.deleteMessage(e.id)},onEditMessage:function(t){return r.editMessage(e.id)}},null,8,["content","icon","timestamp","displayName","isMine","onDeleteMessage","onEditMessage"])})),128))]})),_:1})],512)]),Object(i["g"])("div",b,[Object(i["g"])("div",m,[Object(i["t"])(Object(i["g"])("textarea",{class:"form__textarea","onUpdate:modelValue":t[0]||(t[0]=function(e){return c.inputText=e}),placeholder:"メッセージを入力..",onKeyup:t[1]||(t[1]=function(){return r.keyup&&r.keyup.apply(r,arguments)})},null,544),[[i["q"],c.inputText]]),Object(i["g"])("button",{class:"form__submit",onClick:t[2]||(t[2]=function(){return r.submit&&r.submit.apply(r,arguments)})},"送信する")])])])}n("c740"),n("a434"),n("7db0"),n("d3b7");var g=["src"],O={class:"content"},j={key:0,class:"displayName"};function v(e,t,n,s,c,r){var o=Object(i["o"])("mdicon");return Object(i["k"])(),Object(i["f"])("div",null,[Object(i["g"])("div",{class:Object(i["j"])(["container",{container__isMine:n.isMine}])},[n.isMine?Object(i["e"])("",!0):(Object(i["k"])(),Object(i["f"])("img",{key:0,class:"icon",src:n.icon},null,8,g)),Object(i["g"])("div",O,[Object(i["t"])(Object(i["g"])("div",{class:"chips",onMouseover:t[2]||(t[2]=function(e){return c.isMouseOnChips=!0}),onMouseleave:t[3]||(t[3]=function(e){return c.isMouseOnChips=!1})},[Object(i["g"])("button",{onClick:t[0]||(t[0]=function(t){return e.$emit("editMessage")})},[Object(i["h"])(o,{name:"pencil"})]),Object(i["g"])("button",{onClick:t[1]||(t[1]=function(t){return e.$emit("deleteMessage")})},[Object(i["h"])(o,{name:"delete"})])],544),[[i["r"],r.showChips]]),n.isMine?Object(i["e"])("",!0):(Object(i["k"])(),Object(i["f"])("span",j,Object(i["p"])(n.displayName),1)),Object(i["g"])("div",{class:Object(i["j"])(["card",{card__isMine:n.isMine}]),onMouseover:t[4]||(t[4]=function(e){return c.isMouseOnCard=!0}),onMouseleave:t[5]||(t[5]=function(e){return c.isMouseOnCard=!1})},Object(i["p"])(n.content),35)]),Object(i["g"])("div",{class:Object(i["j"])(["timestamp",{timestamp__isMine:n.isMine}])},[Object(i["g"])("span",null,Object(i["p"])(r.date),1)],2)],2)])}var M={name:"Messsage",data:function(){return{isMouseOnChips:!1,isMouseOnCard:!1}},props:{id:String,content:String,displayName:String,timestamp:Object,icon:String,isMine:Boolean},computed:{date:function(){return this.timestamp.toLocaleString()},showChips:function(){return(this.isMouseOnChips||this.isMouseOnCard)&&this.isMine}}},y=(n("99f3"),n("6b0d")),k=n.n(y);const _=k()(M,[["render",v],["__scopeId","data-v-0188b034"]]);var w=_,x=n("5530"),C=(n("159b"),{apiKey:"AIzaSyAEvHRqcZAjYUo2158sinnjGck376Pbg2g",authDomain:"instruction-chat.firebaseapp.com",projectId:"instruction-chat",storageBucket:"instruction-chat.appspot.com",messagingSenderId:"761186809057",appId:"1:761186809057:web:5e49a55a7b8a946583f3a0"}),T=n("4f60");n("256a"),n("1862");T["a"].initializeApp(C);var S=T["a"].firestore(),I=function(){var e=new T["a"].auth.GoogleAuthProvider;return T["a"].auth().useDeviceLanguage(),T["a"].auth().signInWithPopup(e)},P=S.collection("messages"),D=function(e,t){P.add({content:t,uid:e.uid,displayName:e.displayName,icon:e.photoURL,timestamp:T["a"].firestore.FieldValue.serverTimestamp()})},E=function(e){P.doc(e).delete()},N=function(e,t){P.doc(e).update({content:t})},A=function(e){var t=Object(x["a"])({id:e.id},e.data());return null===t.timestamp?t.timestamp=new Date(Date.now()):t.timestamp=t.timestamp.toDate(),t},R=function(e,t,n){P.orderBy("timestamp","asc").onSnapshot((function(i){i.docChanges().forEach((function(i){switch(i.type){case"added":e(A(i.doc));break;case"modified":t(A(i.doc));break;case"removed":n(i.doc.id);break}}))}))},$={name:"Chat",props:{user:Object},components:{Message:w},data:function(){return{inputText:"",messages:[],isEditMode:!1,editTarget:""}},methods:{submit:function(){""!==this.inputText&&(this.isEditMode?(N(this.editTarget,this.inputText),this.isEditMode=!1,this.editTarget=""):D(this.user,this.inputText),this.inputText="")},added:function(e){var t=this;this.checkSender(e),this.messages.push(e),this.$nextTick((function(){var e=t.$refs.container;window.scrollTo({top:e.clientHeight,left:0,behavior:"smooth"})}))},modified:function(e){this.checkSender(e);var t=this.messages.findIndex((function(t){return t.id===e.id}));this.messages.splice(t,1,e)},removed:function(e){var t=this.messages.findIndex((function(t){return t.id===e}));this.messages.splice(t,1)},checkSender:function(e){e.uid===this.user.uid?e.isMine=!0:e.isMine=!1},keyup:function(e){13===e.keyCode&&e.ctrlKey&&this.submit()},deleteMessage:function(e){E(e)},editMessage:function(e){this.isEditMode=!0,this.editTarget=e;var t=this.messages.find((function(t){return t.id===e})).content;this.inputText=t}},created:function(){R(this.added,this.modified,this.removed)}};n("a9dd");const B=k()($,[["render",h],["__scopeId","data-v-b54d8f92"]]);var K=B,L={name:"App",components:{Chat:K},data:function(){return{user:{}}},methods:{login:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,I();case 2:n=t.sent,e.user=n.user;case 4:case"end":return t.stop()}}),t)})))()},login2:function(){var e=this;I().then((function(t){e.user=t.user}))}}};n("3890"),n("3cef");const U=k()(L,[["render",o],["__scopeId","data-v-729dff48"]]);var q=U,z=n("94ed"),G=n("4b99");Object(i["c"])(q).use(G["a"],{icons:{mdiDelete:z["b"],mdiPencil:z["c"]}}).mount("#app")},"593e":function(e,t,n){},"71f2":function(e,t,n){},"99f3":function(e,t,n){"use strict";n("593e")},a9dd:function(e,t,n){"use strict";n("c1e7")},c1e7:function(e,t,n){},d5b7:function(e,t,n){}});
//# sourceMappingURL=app.98f6c104.js.map